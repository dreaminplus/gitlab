# frozen_string_literal: true

module Types
  class VulnerabilityLocationType < BaseObject
    graphql_name 'VulnerabilityLocationType'
    description 'Represents a vulnerability location. The fields with data will depend on the vulnerability report type'

    authorize :read_vulnerability

    field :file, GraphQL::STRING_TYPE, null: true,
          description: 'File where the vulnerability is located'

    field :start_line, GraphQL::STRING_TYPE, null: true,
          description: 'First line where the vulnerability is located'

    field :end_line, GraphQL::STRING_TYPE, null: true,
          description: 'Last line where the vulnerability is located'

    field :operating_system, GraphQL::STRING_TYPE, null: true,
          description: 'Operating system that the vulnerability occurs on'

    field :image, GraphQL::STRING_TYPE, null: true,
          description: 'Container image that the vulnerability occurs on'

    field :param, GraphQL::STRING_TYPE, null: true,
          description: 'Query param for the URL on which the vulnerability occurred'

    field :method, GraphQL::STRING_TYPE, null: true,
          description: 'HTTP method for the URL on which the vulnerability occurred'

    field :hostname, GraphQL::STRING_TYPE, null: true,
          description: 'Host for the URL on which the vulnerability occurred'

    field :path, GraphQL::STRING_TYPE, null: true,
          description: 'Path for the URL on which the vulnerability occurred'
  end
end
