# frozen-string-literal: true

module VulnerabilityGrades
  DEFAULT_GRADES = { f: 0, d: 0, c: 0, b: 0, a: 0 }.freeze

  def vulnerability_grades
    DEFAULT_GRADES.merge(project_grades)
  end

  private

  def project_grades
    project_vulnerability_grades.each_with_object(Hash.new(0)) { |grade, memo| memo[grade] += 1 }
  end

  def project_vulnerability_grades
    projects.has_vulnerabilities
            .with_vulnerability_stats
            .map(&:vulnerability_grade)
  end
end
