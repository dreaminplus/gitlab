# frozen_string_literal: true

require 'spec_helper'

describe VulnerabilityEntity do
  let(:entity) { described_class.new(vulnerability) }
  let(:vulnerability) { create(:vulnerability, project: project, author: user) }
  let(:project) { create(:project) }
  let(:user) { create(:user) }

  subject { entity.as_json }

  it 'exposes vulnerability-specific elements' do
    expect(subject).to match(
      id: vulnerability.id,
      title: vulnerability.title,
      state: vulnerability.state,
      severity: vulnerability.severity,
      confidence: vulnerability.confidence,
      report_type: vulnerability.report_type,
      resolved_on_default_branch: vulnerability.resolved_on_default_branch,
      project_default_branch: vulnerability.project_default_branch
    )
  end
end
