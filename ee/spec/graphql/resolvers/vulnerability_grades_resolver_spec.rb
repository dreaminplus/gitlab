# frozen_string_literal: true

require 'spec_helper'

describe Resolvers::VulnerabilityGradesResolver do
  include GraphqlHelpers

  describe '#resolve' do
    let(:vulnerability_grades) { { f: 1, d: 2, c: 3, b: 4, a: 5 }.freeze }

    subject { resolve(described_class, obj: vulnerable) }

    context 'when the vulnerable is a Group' do
      let(:vulnerable) { instance_double(Group, vulnerability_grades: vulnerability_grades) }

      it { is_expected.to eql(vulnerability_grades) }
    end

    context 'when the vulnerability is an InstanceSecurityDashboard' do
      let(:vulnerable) { instance_double(InstanceSecurityDashboard, vulnerability_grades: vulnerability_grades) }

      it { is_expected.to eql(vulnerability_grades) }
    end
  end
end
