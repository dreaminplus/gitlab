# frozen_string_literal: true

RSpec.shared_examples 'having vulnerability grades' do
  let(:vulnerability) { create(:vulnerability, :critical) }
  let(:projects) { Project.where(id: vulnerability.project) }
  let(:expected_grade_counts) { [0, 0, 0, 0, 1] }

  subject { vulnerable.vulnerability_letter_grades.sort_by(&:letter).map(&:count) }

  before do
    allow(vulnerable).to receive(:projects).and_return(projects)
  end

  it { is_expected.to eql(expected_grade_counts) }
end
