# frozen_string_literal: true

RSpec.shared_examples 'having vulnerability grades' do
  let(:vulnerability) { create(:vulnerability, :critical) }
  let(:projects) { Project.where(id: vulnerability.project) }
  let(:expected_grades) { { f: 1, d: 0, c: 0, b: 0, a: 0 } }

  subject { vulnerable.vulnerability_grades }

  before do
    allow(vulnerable).to receive(:projects).and_return(projects)
    allow_next_instance_of(Project) { |project| allow(project).to receive(:vulnerability_grade).and_return(:f) }
  end

  it { is_expected.to eql(expected_grades) }
end
